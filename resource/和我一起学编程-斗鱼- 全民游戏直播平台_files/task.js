var task_obj=(function(){var m=[{name:"email",tid:"1",enable:1,element:"tr.t_email"},{name:"settx",tid:"2",enable:1,element:"tr.t_settx"},{name:"share",tid:"3",enable:1,element:"tr.t_share",maxnum:100,donum:0},{name:"sign",tid:"4",enable:1,element:"tr.t_sign",maxnum:2,donum:0},{name:"loginapp",tid:"5",enable:0,element:"tr.t_loginapp"},{name:"appcheck",tid:"10",enable:1,element:"tr.t_appcheck"},{name:"bindphone",tid:"14",enable:1,element:"tr.t_bindphone"},{name:"regold",tid:"59",enable:1,element:"tr.t_regold"},{name:"yeyou",tid:"11",enable:1,element:"tr.t_game_tlzj_reg"},{name:"yeyou",tid:"12",enable:0,element:"tr.t_game_tlzj_sign"},{name:"yeyou",tid:"13",enable:0,element:"tr.t_game_tlzj_gold",iconcls:"t_dragon",maxnum:5,donum:0},{name:"yeyou",tid:"9",enable:0,element:"tr.t_game_wzzh_grade",iconcls:"wz_grade",maxnum:4,donum:0},{name:"phone_game",tid:"15",enable:1,element:"tr.t_game_phone_down"},{name:"yeyou",tid:"16",enable:1,element:"tr.t_game_sy_levelup"},{name:"yeyou",tid:"17",enable:1,element:"tr.t_game_sy_grade",iconcls:"sy_grade",maxnum:3,donum:0},{name:"yeyou",tid:"18",enable:1,element:"tr.t_game_sy_gold",iconcls:"t_cogold_lv",maxnum:7,donum:0},{name:"yeyou",tid:"19",enable:1,element:"tr.t_game_qjgl_login"},{name:"yeyou",tid:"20",enable:1,element:"tr.t_game_qjgl_gold",iconcls:"t_dragon",maxnum:5,donum:0},{name:"yeyou",tid:"21",enable:1,element:"tr.t_game_mycs_login"},{name:"yeyou",tid:"22",enable:1,element:"tr.t_game_mycs_gold",iconcls:"t_cogold_lv",maxnum:7,donum:0},{name:"yeyou",tid:"23",enable:1,element:"tr.t_game_mycs_levelup",iconcls:"t_mycs_lv",maxnum:7,donum:0},{name:"yeyou",tid:"24",enable:1,element:"tr.t_game_mycs_newlevelup",iconcls:"t_mycs_newlv",maxnum:4,donum:0},{name:"yeyou",tid:"25",enable:1,element:"tr.t_game_dhd_login"},{name:"yeyou",tid:"26",enable:1,element:"tr.t_game_dhd_gold",iconcls:"t_gcld_lv",maxnum:7,donum:0},{name:"yeyou",tid:"27",enable:1,element:"tr.t_game_dhd_level",iconcls:"t_dhd_grade",maxnum:8,donum:0},{name:"yeyou",tid:"28",enable:1,element:"tr.t_game_yxhg_login"},{name:"yeyou",tid:"29",enable:1,element:"tr.t_game_yxhg_gold",iconcls:"t_chero_rec",maxnum:7,donum:0},{name:"yeyou",tid:"30",enable:1,element:"tr.t_game_yxhg_levelup",iconcls:"t_chero_rank",maxnum:4,donum:0},{name:"yeyou",tid:"31",enable:1,element:"tr.t_game_yxhg_achieve",iconcls:"t_chero_achieve",maxnum:3,donum:0},{name:"yeyou",tid:"32",enable:1,element:"tr.t_game_yxhg_card"},{name:"yeyou",tid:"33",enable:1,element:"tr.t_game_yxhg_arm_levelup",iconcls:"t_chero_bhq",maxnum:3,donum:0},{name:"yeyou",tid:"34",enable:1,element:"tr.t_game_jtxc_login"},{name:"yeyou",tid:"35",enable:1,element:"tr.t_game_jtxc_gold",iconcls:"t_gcld_lv",maxnum:5,donum:0},{name:"yeyou",tid:"36",enable:1,element:"tr.t_game_jtxc_levelup",iconcls:"t_jtxc_grade",maxnum:4,donum:0},{name:"yeyou",tid:"37",enable:1,element:"tr.t_game_gcld_login"},{name:"yeyou",tid:"38",enable:1,element:"tr.t_game_gcld_gold",iconcls:"t_gcld_lv",maxnum:5,donum:0},{name:"yeyou",tid:"39",enable:1,element:"tr.t_game_gcld_levelup",iconcls:"t_gcld_grade",maxnum:4,donum:0},{name:"yeyou",tid:"40",enable:1,element:"tr.t_game_qwzb_login"},{name:"yeyou",tid:"41",enable:1,element:"tr.t_game_qwzb_level",iconcls:"t_qwzb_lv",maxnum:6,donum:0},{name:"yeyou",tid:"42",enable:1,element:"tr.t_game_qwzb_gold",iconcls:"t_qwzb_gold",maxnum:6,donum:0},{name:"yeyou",tid:"43",enable:1,element:"tr.t_game_dtszj_login"},{name:"yeyou",tid:"44",enable:1,element:"tr.t_game_dtszj_gold",iconcls:"t_qwzb_gold",maxnum:6,donum:0},{name:"yeyou",tid:"45",enable:1,element:"tr.t_game_dtszj_level",iconcls:"t_dtszj_lv",maxnum:5,donum:0},{name:"yeyou",tid:"46",enable:1,element:"tr.t_game_ltzn_login"},{name:"yeyou",tid:"47",enable:1,element:"tr.t_game_ltzn_gold",iconcls:"t_qwzb_gold",maxnum:6,donum:0},{name:"yeyou",tid:"48",enable:1,element:"tr.t_game_ltzn_level",iconcls:"t_ltzn_lv",maxnum:5,donum:0},{name:"yeyou",tid:"49",enable:1,element:"tr.t_game_sgws_login"},{name:"yeyou",tid:"50",enable:1,element:"tr.t_game_sgws_gold",iconcls:"t_qwzb_gold",maxnum:6,donum:0},{name:"yeyou",tid:"51",enable:1,element:"tr.t_game_sgws_levelup",iconcls:"t_sgws_lv",maxnum:5,donum:0},{name:"yeyou",tid:"52",enable:1,element:"tr.t_game_dymj_login"},{name:"yeyou",tid:"53",enable:1,element:"tr.t_game_dymj_gold",iconcls:"t_sgmj_lv",maxnum:5,donum:0},{name:"yeyou",tid:"54",enable:1,element:"tr.t_game_dymj_levelup",iconcls:"t_sgmj",maxnum:5,donum:0},{name:"yeyou",tid:"55",enable:1,element:"tr.t_game_cqby_login"},{name:"yeyou",tid:"56",enable:1,element:"tr.t_game_cqby_gold",iconcls:"t_qwzb_gold",maxnum:6,donum:0},{name:"yeyou",tid:"57",enable:1,element:"tr.t_game_cqby_level",iconcls:"t_cqby_lv",maxnum:5,donum:0},{name:"yeyou",tid:"58",enable:1,element:"tr.t_game_cqby_battle",iconcls:"t_cqby",maxnum:10,donum:0},];if(typeof first_tasklist!=="undefined"){m=m.concat(first_tasklist)}var b=0;var o=0;var e=0;var d=null;function q(){$("#rwbut").show();for(var r in m){if(!m[r].enable){$("#js_task_id_"+m[r].tid).remove()}else{if($("#js_task_id_"+m[r].tid).length<=0){m[r].enable=0}else{$(m[r].element).find("button.task_btn").attr("tid",m[r].tid)}}}$("#rwbut").bind("mouseover",function(){$("#rwbut").removeClass();if($("#js_task_frame").is(":hidden")){$("#rwbut").addClass("task task_hover task_expand task_expand_hover fl")}else{$("#rwbut").addClass("task task_hover task_expand_hover fl")}});$("#rwbut").bind("mouseleave",function(){$("#rwbut").removeClass();if($("#js_task_frame").is(":hidden")){$("#rwbut").addClass("task  task_expand fl")}else{$("#rwbut").addClass("task  task_expand_hover  fl")}});$("#rwbut").click(function(){o=1;var s=check_user_login();if(!s){user_dialog.open_login();return false}if($("#js_task_frame").is(":hidden")){$("#taskload").show();n();$("#rwbut").removeClass();$("#rwbut").addClass("task task_hover task_expand_hover fl")}else{$("#js_task_frame").hide()}return false});$(".js_task_btn").click(function(){if(!check_login()){return false}var s=$(this).attr("rel");if(!s){if($(this).attr("jurl")){window.open($(this).attr("jurl"))}}else{f($(this).attr("tid"),$(this).attr("aid"))}return false});$("#js_task_frame .task_close").click(function(){$("#js_task_frame").hide();o=0});$("div.task_lead_cont").click(function(){$("div.task_lead").hide();$("div.task_lead_cont").hide()})}function p(s){for(var r in m){if(Number(m[r].tid)==Number(s)){return m[r]}}return null}function k(r,s){if(get_cookie("showtasktip")=="1"){return}$("div.task_lead").show();if(r){$("div.task_lead_cont i.num").html(r)}if(s){if(typeof(number_format)==="function"){s=number_format(s)}$("div.task_lead_cont i.gold").html(s)}$("div.task_lead_cont").show();setCookie("showtasktip","1",86400)}function h(r){$.dialog.tips_black(r,3)}function n(){e=0;d=setTimeout("task_obj.rwreturn_show()",10000);thisMovie("WebRoom").js_queryTask()}function i(){if(e==0){e=2;h("任务列表加载失败，请手动点击任务按钮重新打开！");if(d){clearTimeout(d)}}}function c(){var u=0,w=0;var t=0,v=0;var s="";var r=0;$.each($(".js_task_li"),function(y,z){var x=0;w=$(z).find("dl dd").length;for(var y=0;y<w;y++){if(w>0&&r==0){r=1;$(z).find("dl dd").eq(0).click()}$(z).find("dl dd").eq(0).addClass("cur");if(typeof $(z).find("dl dd").eq(y).data("over_num")!="undefined"&&typeof $(z).find("dl dd").eq(y).data("over_num")!="NaN"){x+=parseInt($(z).find("dl dd").eq(y).data("over_num"))}}if(w>0){if(x>0){$(z).find(".js_task_over_num").html(x)}else{$(z).find(".js_task_over_num").hide()}u=$(z).find("dl dd.geted").length;s=(w>0)?(" ("+u+"/"+w+")"):"";$(z).find(".js_task_num").html(s);t+=u;v+=w}else{$(z).remove()}});return{active:t,total:v}}function f(s,r){if((s!=1)&&($("#js_task_id_1").length>0)&&($("#js_task_id_1").data("rel")!=1)){h("验证QQ邮箱后才能领取哦！");return false}$("#lyzm").data("code_type",0);$("#lyzm,#back").show();user_form.update_vcode("task_captcha");$("#taskid").val(s);$("#ad_id").val(r);$("#task_ca").val("")}function l(x){var y=Sttdecode(x);var r=parseInt(y[0]["value"]);var z=number_format(y[5]["value"]);var v=y[1]["value"];var s=y[6]["value"];switch(r){case 216:h("绑定手机和验证QQ邮箱后才能领取哦！");return false;case 218:h("绑定手机之后才能领取鱼丸!");return false;case 219:h("验证QQ邮箱后才能领取哦！");return false}if(r==0){var w=p(v);if(w==null){return}if($("#header").length>0){$("#ywtit").html("鱼丸 "+z)}else{$("#ywtit").html(z)}$("#ywtit").data("value",z);if(w.name=="phone_game"){w.element=$("#js_task_id_"+v+"_"+s)}else{w.element=$("#js_task_id_"+v)}if(w.maxnum&&w.maxnum>1){if(w.donum>=w.maxnum){$(w.element).remove()}else{$(w.element).removeClass("geted");$(w.element).find(".state").html("("+w.donum+"/"+w.maxnum+")");if(w.is_new==1){var u=w.donum>0?w.donum:1;$(".js_task_id_"+w.tid).hide();$(".js_task_id_"+w.tid+"_"+u).show()}else{var u=w.iconcls+" "+w.iconcls+(w.donum+1);$(w.element).find("span."+w.iconcls).removeClass("").addClass(u)}}}else{$(w.element).remove()}h("恭喜您，已成功领取"+y[3]["value"]+"个鱼丸！");var t=$(w.element).data("pse");if(t!=null&&t!=""){$(".js_total_gogle").html(t)}$(w.element).parent().parent().find(".js_task_over_num").html("").hide();$(w.element).removeClass("geted");$(w.element).data("rel","");$(w.element).data("over_num",0);var A=parseInt($(".js_task_psnum").html())-1;if(w.name=="sign"&&b>0){A++}$(".js_task_psnum").html(A);if(A<1){$(".js_task_psnum").hide()}else{$(".js_task_psnum").show()}$("#tasktab_complete").find(w.element).remove();c()}}function a(s,r){$(s.element).data("tid",s.tid);$(s.element).data("aid",r.adid);if(r.anum>=1&&r.ps<=0){$(s.element).remove();return}$(s.element).show();if(r.anum>0&&r.ps>0){$(s.element).addClass("geted");$(s.element).data("rel",1);$(s.element).data("over_num",1);$(s.element).find(".state").html("(1/1)")}else{if(r.ps<0){$(s.element).removeClass("geted");$(s.element).data("over_num",0);$(s.element).data("rel","");$(s.element).find(".state").html("(0/1)")}}}function g(u,s,t){$(u.element).data("tid",u.tid);$(u.element).data("aid",u.aid);$(u.element).data("pse",s.pse);if(s.anum>0&&s.ps>0){$(u.element).data("total_gold",s.pss);$(u.element).addClass("geted");$(u.element).data("rel",1)}else{if(s.ps<=0){$(u.element).data("total_gold",s.pse);$(u.element).removeClass("geted");$(u.element).data("rel","")}}$(u.element).data("over_num",s.ps);$(u.element).find(".state").html("("+u.donum+"/"+u.maxnum+")");var r=((u.donum+1)>u.maxnum)?u.maxnum:(u.donum+1);if(u.is_new!=1){var v=t+" "+t+r;$(u.element).find("span."+t).removeClass("").addClass(v)}else{var t=u.donum>0?u.donum:1;$(".js_task_id_"+u.tid).hide();$(".js_task_id_"+u.tid+"_"+t).show()}}function j(v){clearTimeout(d);if(e==2){return false}var w=Sttdecode(v);var A=w[0]["value"];A=A.replace(new RegExp("@A","g"),"@");var x=Sttdecode(A);var B=0;var C=0;var z=8;if(x[6]["name"]=="tid"){z=6}var s=(x.length-1)/z-1;$("#tasktab_complete table tbody").empty();for(var D=0;D<=s;D++){var t=x[D*z]["value"];var r={anum:parseInt(x[D*z+1]["value"]),ps:parseInt(x[D*z+2]["value"]),pgs:x[D*z+3]["value"],pss:parseInt(x[D*z+4]["value"]),pse:parseInt(x[D*z+5]["value"]),adid:parseInt(x[D*z+6]["value"])};if(z==6){r.pse=0;r.adid=0}B+=r.pse;var u=p(t);if(u==null){continue}if(u.name=="phone_game"){u.element=$("#js_task_id_"+t+"_"+r.adid)}else{u.element=$("#js_task_id_"+t)}if(u.maxnum&&u.maxnum>1){u.donum=r.anum;if(r.anum>=u.maxnum&&r.ps<=0){$(u.element).remove()}if(r.anum<=u.maxnum&&r.ps>0){C++}$(u.element).show();g(u,r,u.iconcls)}else{if(r.anum>0&&r.ps>0){C++}a(u,r)}if(r.anum>0&&r.ps>0&&u.enable){$("#tasktab_complete table tbody").append($(u.element).clone())}}if(C>0){$(".js_task_psnum").html(C).show()}else{$(".js_task_psnum").hide()}if(o){$("#js_task_frame").show();$("#taskload").hide();scrollContH=$("#js_scroll_bar .overview").height();wordWarp=scrollContH-$("#js_scroll_bar").height();scrollThumbH=$("#js_scroll_bar").height()/scrollContH*$("#js_scroll_bar .s_bar").height();if(scrollContH>$("#js_scroll_bar").height()){$("#js_scroll_bar .s_bar span").css("display","block");$("#js_scroll_bar .s_bar span").css({height:scrollThumbH+"px"})}else{$("#js_scroll_bar .s_bar span").css("display","none")}}var y=c();k(y.total-y.active,B)}return{init:q,sign_send:function(){thisMovie("WebRoom").js_roomSignUp()},return_sign:function(t){var r=Sttdecode(t);if(r[0]["value"]==0){$("#signbut").hide();$("#signbut2").show();sign_stat=1;b++;if($("#check_sign").attr("rel")!=1&&b<=1){var s=parseInt($(".js_task_psnum").html());if(s==null||isNaN(s)){s=0}$(".js_task_psnum").html(s+1).show()}}},reload_img:function(s){loading.show("正在获取验证码");var r=$("#"+s).data("src")+"?_t="+Math.random(1);$("#"+s).attr("src",r)},reward_send_rpc:function(){if($("#task_ca").val().length!=4){h("请填写正确的验证码!",1);return false}$.ajax({type:"POST",url:"/member/task/reward",data:$("#lyzmfrm").serialize(),dataType:"json",beforeSend:function(){loading.show()},success:function(r){if(r.ret>0){if(r.ret==2){$.dialog({content:"当前ip输入验证码时错误次数过多，请等待一天后在重新尝试！",icon:"warning",okVal:"确定",ok:function(){}})}else{$.dialog.tips_black(r.str,1);user_form.update_vcode("task_captcha");$("#task_ca").val("")}}else{$("#lyzm,#back").hide();$("#taskid").val("");var s=[{name:"r",value:0},{name:"tid",value:r.tid},{name:"mg",value:r.data.mg},{name:"ms",value:r.data.ms},{name:"gb",value:r.data.gb},{name:"sb",value:r.data.sb},{name:"aid",value:r.aid}];var t=Sttencode(s);l(t)}},complete:function(){loading.close()}})},debug:function(){console.log("g_tasklist=");console.log(m);console.log("rwbut_stat="+o)},rwreturn_show:i,get_task_stat:n,return_task_list:j,show_tasktip:k}})();